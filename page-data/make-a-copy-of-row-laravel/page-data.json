{"componentChunkName":"component---src-templates-blog-post-js","path":"/make-a-copy-of-row-laravel/","webpackCompilationHash":"74e08bd1f829f53045fc","result":{"data":{"site":{"siteMetadata":{"title":"Codycrunch","author":"NicoAudy"}},"markdownRemark":{"id":"ffb5a495-0248-569c-a773-c62f2e7be9db","html":"<hr>\n<p>I would like to write about one of the little-known features of laravel eloquent called <code class=\"language-text\">replicate</code> to copy everything from existing row. Lets see the example, Here Post is my modal, posts is my DB table with sample data and I am selecting single row on top of that I am calling <code class=\"language-text\">replicate()</code> to copy the row, then I am calling save method to <code class=\"language-text\">save(insert)</code> data in the DB table.</p>\n<p><code class=\"language-text\">replicate()</code> – Clone the model into a new, non-existing instance.<br>\n<code class=\"language-text\">save()</code> – Save the model to the database.<br>\n<code class=\"language-text\">push()</code> – Save the model and all of its relationships.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">  Posts<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">replicate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Clone model and modify existing data\nWhile coping existing records(posts), if you what to modify existing data, store the replicated data in a variable then make the changes as shown below</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">// fetch a existing post</span>\n<span class=\"token variable\">$post</span> <span class=\"token operator\">=</span> Post<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$postId</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n<span class=\"token comment\">//Clone a attribute of existing row into a new copy</span>\n<span class=\"token variable\">$duplicatePost</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">replicate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n<span class=\"token comment\">//Change a name of the copy post by appending id of the existing post to make the name of duplicate post unique</span>\n<span class=\"token variable\">$duplicatePost</span>  <span class=\"token operator\">=</span> <span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">name</span> <span class=\"token punctuation\">.</span> <span class=\"token double-quoted-string string\">\" \"</span> <span class=\"token punctuation\">.</span> <span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">id</span><span class=\"token punctuation\">;</span>\n    \n<span class=\"token comment\">//Now create a duplicate post</span>\n<span class=\"token variable\">$duplicatePost</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//fetch a existing post</span>\n<span class=\"token variable\">$post</span><span class=\"token operator\">=</span> Post<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$postId</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n<span class=\"token comment\">//Clone a attribute of existing row into a new copy</span>\n<span class=\"token variable\">$duplicatePost</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">replicate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n<span class=\"token comment\">//Change a name of the copy post by appending id of the existing post to make the name of duplicate post unique</span>\n<span class=\"token variable\">$duplicatePost</span>  <span class=\"token operator\">=</span> <span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">name</span> <span class=\"token punctuation\">.</span> <span class=\"token double-quoted-string string\">\" \"</span> <span class=\"token punctuation\">.</span> <span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">id</span><span class=\"token punctuation\">;</span>\n    \n<span class=\"token comment\">//Now create a duplicate post</span>\n<span class=\"token variable\">$duplicatePost</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This method works with loops and relationships too, so you can use this method to duplicate all of our entries.</p>\n<p>Clone model and it’s relationship\nHere each post belongs to tags and categories, lets copy everything and save it to database.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$clone</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">replicate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$clone</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//Push before to get id of $clone</span>\n\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">tags</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$tag</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$clone</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">tags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$tag</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">categories</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$category</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$clone</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">categories</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$category</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$clone</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">replicate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$clone</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//Push before to get id of $clone</span>\n \n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">tags</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$tag</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$clone</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">tags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$tag</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n \n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">categories</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$category</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$clone</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">categories</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$category</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>NOTE- you may set the timestamps to the second argument of attach().</p>","timeToRead":2,"frontmatter":{"title":"Make a copy of row - Laravel","date":"July 01, 2019","spoiler":"Lets see the example how to make a copy of row"},"fields":{"slug":"/make-a-copy-of-row-laravel/","langKey":"en"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/make-a-copy-of-row-laravel/","previous":{"fields":{"slug":"/laravel-trick/","langKey":"en","directoryName":"laravel-trick","maybeAbsoluteLinks":[]},"frontmatter":{"title":"Laravel Tricks"}},"next":{"fields":{"slug":"/vue-select-in-nested-data/","langKey":"en","directoryName":"vue-select-in-nested-data","maybeAbsoluteLinks":[]},"frontmatter":{"title":"Vue select in nested data"}},"translations":[],"translatedLinks":[]}}}